function [Y,Xf,Af] = Abroke(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 01-Jul-2021 15:30:45.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx6 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx2 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-4.99999999999909;-42.0000000000002;-38;-10.9999999999845;-7.99999999996135;-7.99999999999136];
x1_step1.gain = [0.0689655172413826;0.00782778864970649;0.0402588701678506;0.0754716981131719;0.0885110709979152;0.0816326530613593];
x1_step1.ymin = -1;

% Layer 1
b1 = [-26.338440946648965735;-1.3544734183200604072;2.9033283737207584707;3.3827433207875277077;-3.4660799946284850392;4.5649700388928780015;2.8987244463804024974;30.153779946753903829;-2.4130851398915877937;-2.8438108782802338226;1.9869993449575558131;-3.6860951959480399154;-4.2238768999129003845;-4.2607048756677121659;2.1230448252582552193;2.8654203205489863215;3.1754438371902846683;-0.20474189767111228289;-2.1220996777496452523;-0.4885512108900664785;-5.0557946854212074683;2.1509661229926559933;0.76331860085849523312;3.1418767308716142317;0.3828273385947729146;-2.1870594730523844618;-1.0398118453640721182;1.4692010217842381703;-3.8961973993446972209;0.016593341150799273409;4.0470225731453943752;-0.26418731856706600958;-3.3984357009256309645;0.99730866037463117291;-1.6618103195753439749;-0.52449965654419006267;2.2987051019928683715;2.5669347098237476068;1.8938078076776407865;1.4850376623572094648;0.39525157769172269973;0.28078989485330435594;1.4076359243186682413;-1.2470712521355671321;-0.057263041572642871258;-1.1740881521389809894;0.51689203510898273919;0.90690219387342541069;-0.030639447181042760854;-2.1126216831484749825;-2.0682544047504678453;-1.3021166855350312375;-0.2873515554281654838;-1.6811405465553836969;-5.0565658046284074345;1.9267298983627814124;2.6474471753933790374;-0.9889117646469101075;-3.5651787423215304251;0.15764541216754701658;5.3161998334539894984;-2.3288933133181659585;-0.4779679702903656402;0.87443722058218698034;2.173271448543221851;-0.69600659689826960275;1.0318045092699339449;2.0224202370848263222;1.1977555659069401006;-2.4195404506505133746;0.20811710304455471876;-0.099881626330707337647;-0.64348967026716230588;-1.2356550573870355159;-0.17335937552639016368;1.1693250342857210988;-1.6389399809426361543;0.96575202244358993031;-1.4742815494732288695;-1.5426760564256920549;-3.157747034642010231;-1.9387813668149722623;-4.3480135811169411397;2.2694698375236885823;-2.0691067079119815908;-0.38320671077513024372;-2.9362968300160230406;-0.42349754017242363657;4.219588668100228368;2.9867687905073490029;5.5426280495183792851;-3.5698091788855199624;2.9976060711547818372;-1.308201614403854407;5.1510136097480039297;-5.6415669868459579206;-2.9554825470488754746;3.6403921025105514531;-1.7300667581745292622;6.6169245718010802904];
IW1_1 = [0.15226960292710040035 -37.178963972632985246 1.6303377747103602324 -0.22278649806656850019 -0.38727294254418992425 0.36522058792809841687;-1.4459430691228014609 -0.16892309506145974929 -4.0531841231741791987 -2.7494869724131554278 0.40883951290049858063 -1.4335437307779199667;-0.77454454570537190072 0.014404856668397685027 2.0296403243413196904 2.2353811603676700948 -2.0853781709600371919 1.4036169405080993755;-0.41735010293130403447 -2.3756799198408531382 1.253823406987995881 0.22723697907524087469 -1.5150610819439636057 1.6040974254357418527;1.5684888783040720206 -0.51710551884070332651 -1.5401668349291683935 -0.77036483908341535365 1.9877159738902503427 1.8415670666418468837;-0.57165425483018095232 4.1409993784324665711 -1.622890809310144844 0.23815205990082916054 2.1036318191123695165 0.65151733459377036972;-1.7507505792896260743 -1.1081592570218772309 0.70581111562030085516 1.1784029932587951617 1.54149050355029682 -0.050949567012695734514;-0.20943253994796429129 42.378353374126618291 -1.9273383605952607578 0.23677034977715732955 0.417492194175706266 -0.3372136237519129387;2.9603936604176630532 -1.1745976496065548833 -1.1484578354687808854 -0.73639427535902357569 0.23660358578842924371 0.08201756022485615083;3.1640584053048539381 -1.2141949441420818445 0.0074274818459426489303 2.858614971569655161 -1.7109024169182662778 -0.2733496296526281566;-1.7732602324386594894 -0.86325609677210990434 -0.30393268316042881816 -1.5259757431273535122 2.2816030916096239345 1.0288724744991943894;-0.76818967118791314785 -4.6866288357787144747 0.016471885035952427145 -6.1868554409693041762 -0.86301665573520647268 -0.86984179518221349525;3.1636347390352472786 -0.47909650431208433696 10.050232724048907329 6.004887006099435709 -3.0104261034425490173 2.9923366500460755191;-0.6064905542172405184 -1.8644243832806950412 1.6432566903357872512 4.1959942383979420555 -0.60304924230053547074 2.2344064757564225943;-2.3122124783732860287 -3.0355821273538468041 -4.1583346203001365637 -1.7986174726735812968 -1.3411021792653330387 1.8814681219128150946;-1.0592934782971636931 -0.070961192197747713362 3.016721151511785326 0.88846154293928814027 1.8581042650514310033 -0.7530424247843754415;-1.9787163550488020558 0.29568008955383495717 0.96300376400984344372 -1.0458965284075096847 -2.5004163846336080468 -2.1219587249755171854;0.025071920912882749571 0.11607715498873744098 -0.21478831012011451174 1.9734694813553657067 4.402471469059355158 2.0660762472466704942;3.7598122704573269104 -3.3491195125394925824 1.2111929461819794795 2.4001128485888600927 -2.6007017270578285384 5.0456589963993074832;2.3745854376367003802 1.6097613019653358446 0.6195454146169361298 1.5877310518722207444 -1.8841985753529868486 -2.3144850628908355539;-2.0198577167914990582 0.25354396225569619805 1.0611633841181351556 -2.1159442883851955486 -1.0676889932108395431 -5.7060063920658024017;-1.6341730804081282535 -0.22408234215264782874 -0.68061454085299943895 1.5978515140975055875 1.0958953448538124587 0.81495156268720214676;-0.70387349289425493737 -1.4862449993417325977 1.8746331954688988386 2.1273519585537128407 1.4236061148130010334 1.9761508861982912677;1.8312338519371471612 -2.3451952897456584957 -1.6400518893613382776 1.2518166240893060515 0.19101316050348676745 4.1517135460788807677;-0.18402548270315632895 -4.5663098639085957231 -2.7043866344730411733 1.0748497600617763492 3.3442603853141705805 -0.91537265442253135106;0.36411509375862949334 -2.5821753920858161457 -0.55113005418345084596 0.089141295181492885558 -3.4104220756892833499 -1.2836827810713158371;1.2191728122255578448 0.77858532171207228689 0.6911115475769842309 0.92589078580790307171 -1.8272249803040281346 -1.6698632928281809118;-0.36851194303415701903 -1.7907163837384765248 -3.0352443680155225536 -1.4094949351962464679 0.31643445399404268592 -1.3132564366458723271;0.60779399534667499783 -2.3814091282028702068 -0.8980168235935469534 0.22523011378920598791 2.9888542932804789132 -15.609705647273813156;-0.99890789692008752354 0.65802364706214999668 -5.7522554789343987025 1.4345423820923144387 -0.49968273505548443936 -2.3600249003570019646;-0.67199749489969962113 -0.15006863942753162489 -5.2336347966718035352 -1.6202160470995223829 -4.4215648303705448185 9.8925113784026024177;-0.50156291518379225725 -2.313955626653544595 -3.2811785932613726224 -5.7371077756137207615 1.6234803698847661835 -5.1690789995467056883;5.0052963468708853156 -4.6915884442279924826 3.2738425597534153155 -0.43054660581274950548 -0.35327204909351994644 0.93548140658346956577;2.2732969954945820845 0.88912419118332075563 -0.32221748620796536455 -1.3626030126796160324 -3.9349106191871583427 -0.00881287133784646598;0.33506825538358581129 -0.20679979074511281589 0.45096407518850989415 -4.2063387053092355927 4.1409571269007896532 1.3511574116834870196;0.91830872513224104381 2.0135026431526710233 -1.6308473462712909097 1.0660043471924192104 -0.42107410890812457804 0.76440451943032150517;-1.403712566392888661 2.5871590416447043381 -0.36695429641884858007 -0.64118255539463708814 0.11756134945875086617 -1.8786768791929429057;-0.012511513844523897143 0.59991775115184908795 -1.3899829365316747065 -1.2104395759502364349 -2.9109922930529146257 4.8555827545263374745;0.78178021999381308582 1.947759556044172724 -0.024931608189490590821 -3.4639565714220394987 -7.8435260414167915499 -0.51365430165558900732;-0.16674390910626335494 -1.2397618046919194335 1.6850945326155721826 1.881835479787518528 4.4328337086390900978 0.51067895094518256371;-0.59452437402301949732 2.446966029405179377 -0.59235961963643957162 1.1817952071655741797 -2.2811690724564082089 -0.32749646460008169369;-0.093003386189298598019 0.19350813756023263479 -0.14596334747120465192 -9.4158211940129508122 2.5072080868105373064 -0.95783648610452909455;-0.62922744541749797698 -1.2678522042831539274 -1.794298501467012974 -2.6443568919170306053 -1.8877635371984737844 1.0713399394530049857;2.1968473063752069763 1.1312777439541183977 -0.20594802601944034448 -1.1229798591907742544 2.5327510967237114592 -0.98199167528069641886;-0.12252492735132634871 -5.6106691778384112368 -5.8412810140940099046 1.0779924098660749188 -3.3570984823440284117 0.82507826206882972642;2.780355346022170604 1.078988020295219119 1.4467404987535379401 -3.3942853384334430444 3.1191520922597795185 -2.0116671822665050939;-0.43751339564762425915 3.4456707124981087453 0.23781147522460782673 -5.9608692710156043759 -4.8045394444395705946 -0.79990818188951062773;-1.6395929754446505466 -2.1797865277014198959 -0.73994736382941539432 4.6373822973649119206 -1.7872421604031032416 0.41076539614188573024;-6.8811151090915725348 1.3267332613096365357 -4.9125200507737467603 1.3708864119231445322 1.5154073819188091932 0.29986059425400635181;-0.6110873530602949355 4.262000325123356248 8.6249272415550528592 -8.1861504330246379624 2.1227094443171790061 1.6989342775807361186;-0.37786650845542973931 3.2310477123127796517 10.898507545357674076 0.96752245799834357687 -1.2250253672608140132 2.0468498911257273498;0.86854240939149462974 -3.6640028934801867067 1.5352154834052276211 0.51402276821525805239 -0.12788424574704423953 -0.58760681589291374749;-7.9569692413280712628 1.3801792046190084484 -5.6301265503866648743 1.7835560831333863163 1.820687381540728067 0.39743841945522684345;0.6429295643107741931 -3.9966009019990007545 -0.078711064791109688898 -1.3537628376927262064 -1.597871921376215365 -1.7164725145194532629;0.32364521288006259381 -0.40294530684458851333 8.9084913553679516696 -3.128767198495761015 -2.1258911067026908803 -3.1695786428495429377;-0.24147265275127791084 4.7550276162012563574 -1.1202749229606878689 -1.1616255238372996672 -5.8696018069481912249 -5.1839943486186816912;-3.1337858758404859572 6.6552682504193469981 -1.8193093710264045537 2.6292728640259448447 5.504148345704917844 -2.1876918094229003131;0.31026739338517966837 -0.72459138825134039585 0.066633062744441626246 -5.2807421677712023111 2.5341725630946276837 0.2571148048595786606;0.0017505427620092273155 -4.9260694536822198231 0.8746880342103613426 3.8580650533177616168 -0.026670411830283222154 -3.4961941522119337478;3.4067724758261204165 -3.2829035775607446901 1.064331257243484874 -4.1625721766140344471 1.4735893128855992451 -1.6098450621864930365;3.0411291975775616159 0.15442096639098173982 -7.1239444844772803478 0.28791703657911410508 0.30463918903374503921 0.17680631477085118064;1.2378948562118923249 -1.4659773725598783667 6.7286879848824971972 -1.3489086217274328661 -0.18857420973097038797 3.8740056538557934296;0.80610015950834856824 -0.88702311152063306743 1.7441300382518414303 2.0587348014268433971 0.93845233640463365798 0.35502144678607511219;-0.049480108954909944596 0.21950309941102169597 -1.7188343612389034298 1.4938133348474060824 4.0729318830350234037 1.3109795046190662049;0.74153856922894589854 -3.1895843949189699451 -10.540923421546368743 -3.1622501724606544293 1.3823471616041465015 -7.1731332094754858275;4.1248036073180394112 -5.7205363138976830228 0.92392745831817335578 -2.2193519330546953583 1.0173087184711440134 -2.8178982899984319488;4.0713837347556154356 -1.7750829583283467272 2.7846845068135217538 -1.095444472536412972 -0.81269939920229505859 3.0057687671153909825;0.40743189014481195898 -1.1517291834228753356 0.49778776147406583741 -1.4094415851892230229 4.4401198964519501544 1.1253065533382224928;0.43666944917869010556 0.28165695989148142875 -2.3099245617829784472 2.5598978649941264152 -4.3385061116468461861 0.74179138472870242982;0.492868590086648517 1.5197791343963544808 2.7741529364264172486 -2.7199061033432587742 1.2647026315288576459 -3.264856642896742045;1.2624505610042771053 -2.2953448769293620657 0.036554674961434496794 6.5399263243977054927 3.6689856172548376279 0.57755004238728480104;1.2112442606874507245 -0.27013194956174862993 -0.5917687802981951295 -0.7813675278538382285 -3.6651750413403219042 -0.011196496061958494117;0.12503334978917057807 -1.5061933695122728949 -2.1282061963170266772 2.5728086937237937271 -2.4446944593381472188 0.2860427448395518879;-2.3281737728622942107 1.2713040989932926639 2.5141219830056975582 1.2305220565498617979 -5.3717631595536703415 5.171053111273343994;-0.89654667347400296418 0.83003205285233794264 -2.7154042024250344411 -2.3188318400924612384 0.14135761238896143999 -1.2456733081814030939;3.1367089572722286483 -2.2309785229653300576 0.87518714285554100041 -3.2933667354647520042 0.95209062605109262556 1.1817331073998766922;-0.36018337333906608189 2.3067547511405170901 -1.2740447796038418815 1.5628533523789764903 1.5922815994437997666 -5.0429947712503659929;1.0806499957660535838 -0.64046536782401042309 0.43012982853398057381 2.7460873113069292906 0.24046640871822261287 -4.7864797693253322564;-0.10601381757956369889 -0.091255226468445929666 -1.3082150745983898155 0.42945898226418854904 -2.8825611065539131772 1.1300602699106683247;0.13885684354897168125 -2.3906533528138074196 -2.4317841748151525216 3.0709586030011966074 -1.8668311914357125225 -0.31736995963644826224;-0.44811944335658004945 -1.7087142246738218354 -1.2724302492397849829 -0.66878379738795079579 1.2450184586652370822 3.060833326572050872;-2.6222914009165352311 -2.2545170513130736722 -1.376063855321481455 3.5677345967354106016 -2.0638452647926994743 0.63048392012050280542;0.77200636903132791033 2.6170009692281843705 5.655121792702466621 -1.5352412629735932015 1.6993169497706388515 -4.8400082903302550363;1.2915666722361522911 -0.29808448549388144588 1.2419922060993922042 -1.3072978100077377039 -0.78715737032254340377 3.7839572175674689447;-0.94979703869187104281 2.3939026306767545726 -1.6196389921999303496 -1.0335718334109114114 -0.36809519004844426515 2.1274867801625458874;0.1727445346584937369 -0.10469321718774282637 0.24251509669116458334 11.099163652448417849 -2.7120634215079744145 1.3221300410943208625;-0.63978890460863346856 1.9945575458388054013 2.3887532917913936181 -1.3952213846002980979 3.1836183893476368567 -0.13483101515048775965;0.19619503960883072358 -2.7901681218170861776 0.4938284537661537521 -6.2954562625862706682 -2.3799547795767352909 4.7819425619416131568;2.708691967457198313 2.4674423130716620634 -1.8920798137255250282 -4.7351989750915697286 3.3211552616816151229 -5.5561420619721282321;2.0950413029104786311 0.57640126356648913042 0.90987724284523963103 -2.4558423139328882101 0.51325300354252900714 3.448754340336498192;2.3199596020550297126 1.0401325943103589822 -0.84180837997315205445 0.10788012198761462446 -5.1728730817215087256 1.9137152984060652461;-0.40248971424063290092 -4.8415559363867499698 0.53037997337042952495 3.8001165366718314687 -0.011298746577372439925 0.26374020966456146464;0.57925013386154144968 -1.2420084327272380431 -0.75162176628882626517 -3.8849959708889922894 -1.597979211136044464 0.65476174838970313541;-0.46042798876633628247 0.24548741959212000419 -1.6315380388488922581 -1.9259593010571067762 0.67869757910758865549 1.4099073960403913919;3.4695405536709187366 -2.4370864320335985376 -4.0238243189313749326 0.078534092080521866741 0.40614295532653499343 3.2155340125134879159;-1.3971220746948100899 -4.8361898595814887258 1.6707104451973289194 6.5603863196919824929 0.56512325939391250262 4.292010120817175256;-1.5350854438839349747 -4.5046743244090396985 -3.5158196642821555322 0.0094713471823702002905 0.86126970324028984116 -1.5532295601031718135;3.1342972312310513061 2.0333387229275343699 2.6759342837707542628 -1.1915120790387094818 -2.6793889809261144386 5.3862393917453683656;-1.3736900338527724408 -0.22732792778662946898 -0.17097775456996891497 1.6499754783893225696 -0.26446176128720122467 1.6296681238203740705;2.6036530271423266036 3.6295288978087576481 -4.1390461938399907282 -0.01458273414940414181 -0.48310252158594169103 -0.74189555674370089022];

% Layer 2
b2 = [0.21578556963060890883;0.51798746934448525181];
LW2_1 = [6.5522074251315354232 -1.6394738796492736022 -1.7424790624285952934 1.5862271084655099607 -1.7655367359673352912 -1.7394924567051426312 -0.2123087889516197535 6.4242454530683383851 -0.41709283953427750413 -1.2439210769052249095 -1.7975531338685755145 -0.39049200251849192078 -0.22998277347776924229 -1.2927632129826962526 -0.96319575719968186789 -0.92067811471277039015 -1.8046720405881830906 -0.10766035410762045399 -0.24297762468593170349 2.8398316605057565276 0.71000960017736436392 0.040487824876775047045 -0.52348305613372669853 1.7623232260811889649 -1.0807480700076148583 -1.6009659460539553688 -4.6554343006161866825 1.4073685020565724901 -0.053954051605848291073 0.35327798076733341048 -0.015569899249576402839 0.43895981547765805519 0.58883678047773180264 -0.86578819222320901883 0.38997900231680648897 -0.28904307107081217421 -1.4076247645947173037 -0.0019589904384074222077 -0.45836921086458565222 0.29497513497727329002 1.3975161037726633317 -0.012683067368616594839 -1.1585200876469123887 -1.2735913663658919859 -0.5452281383036626794 -1.0041737607221308259 -1.1706138579553351242 -0.062967834712259918017 1.9323747538672340074 -0.36597510950384776196 -0.14935558706325258171 0.70895128270537755011 -1.5617008275912998005 0.034447414800364284382 -0.15638748250497946923 0.2475803302325199351 -0.30594705112502335043 0.23984042709800501569 0.49335952605429272966 -0.92388909018080156432 -0.78880193164284295726 -0.51648422791888926042 2.19995805257280308 -0.62696812520747069453 -0.038970233792480442336 0.8101976085409566819 0.60449192488465752771 -0.50517853977513083041 0.78557876721207453574 -0.20308778420722595204 -1.0107287039991392774 2.0021330223986129049 -2.7047582802331708862 -0.22831779107194236089 4.0018741673174762497 1.3043087510985249544 -0.12112281017128433136 -0.28622884903044704119 -1.1704515660825289824 1.641106755380306037 -1.0496574906519211545 0.807131047354406439 0.015959753043470963074 0.37951731248507214467 -1.225235965458847387 0.045695704568586972827 1.4530901424102347086 0.21358538635096382952 -0.35953031202072560646 -0.91391359891475543176 0.36607326962402397807 -1.2610969845140307388 1.0466591354303174111 -0.17081478490369259027 -1.3594353574894453285 -0.41153781079792139952 -0.86489196249541810957 -0.40532659598326931105 3.5856585332728054816 1.0392355917284459288;0.78458068385703361169 -0.37706021140848539064 0.62245011051730958496 -1.2276512614582644201 0.39248237595696933155 0.1111817208868384893 0.98157393569854045623 0.70514639811451074181 0.033929740863416206487 -0.015431390949134961288 -0.89875379581276637619 -0.011216433797606612313 -0.073730441872012872362 0.028790951526562483243 -0.074566025908665289901 -1.3575992705711918962 -0.44109740944353448278 -0.71087977446428196604 0.053858725396286562248 0.24185119085918710402 0.84816878783702609468 1.1844503388413190059 1.0375882206235162997 1.4472770278165780766 -0.12446552161429109973 0.0090922234504834109625 -0.61950504989178956095 0.21556659749478257471 0.31966934656901091483 -0.056579804253783332058 -0.24433653653678777395 -0.019235561346557003559 -0.026935769922534501947 -0.22549544170490415373 -0.42422571217968191304 -0.79684151958551796557 -0.23986271023765692867 0.5737270944076486856 -0.10530875553464554006 -0.97407254374231255767 0.4589016161817180417 -3.4815107123060680117 -0.17604880654637222737 -0.33296225304898141584 -0.094730136246679197409 -0.26783771586850763091 0.77111181102979453605 -1.0938141533044447584 0.30351555940038327241 -0.17803039365244535674 0.28517227904386371895 0.57744454444590354036 -0.25957428461639048267 -0.60836915404779978722 0.25761040493435793941 -0.15223631976608795191 -0.068310016369228274136 1.7100488468200576442 0.26798515722918947457 -0.13824836416750585499 -0.025325262996266851429 0.097278112367493230206 0.20507950584023187934 0.55871304216105388551 0.25714759294840378034 0.0043753818655076553643 -0.04981230634889471931 0.42679664306120818074 0.39550728633663595479 -1.5022315791009932529 0.51656847874535261056 0.35704410189292901112 -1.2950056706432022668 -0.018191851938725328575 0.74611360348140054466 0.38145885575951599122 0.93008630550929805025 0.15887547378724958813 -0.89286135241501740634 0.98556991589245324104 -0.92983720814877524052 0.12822460400938223701 1.3821561578161534189 0.98230377271458491073 0.25280214591486471765 -2.4789931621279452933 0.2657108635987322498 -0.19817497064022254749 -0.05667140046164607925 -0.58734017081964173812 0.055529161732904556981 -0.16954986222839341092 0.65792604359372131029 1.0417538922557647574 -0.42818806143261545216 -0.11273804688130430185 0.014186043274740536488 0.075660082099381908982 0.62858272810912907413 0.14059625620049709394];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.0800227111322119;0.0800226083770493];
y1_step1.xoffset = [10.0002462740323;10.0001033766689];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
